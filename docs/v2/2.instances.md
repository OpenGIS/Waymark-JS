---
title: Instances
description: The Instance is the central component of Waymark JS. It is used to display Basemaps, Overlays and an interface for interacting with the Map.
---

## Quick Start

Display a Map with a custom Marker.

```html
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/@ogis/waymark-js/dist/waymark-js.css"
    />
  </head>
  <body>
    <div id="waymark-instance" style="height: 480px"></div>

    <script type="module">
      import { Instance } from "https://unpkg.com/@ogis/waymark-js/dist/waymark-js.js";

      // Create a Waymark Instance with this configuration
      const instance = new Instance({
        // [Map Options](/docs/v2/2.instances.md#map-options)
        map_options: {
          // [MapLibre MapOptions](https://maplibre.org/maplibre-gl-js/docs/API/type-aliases/MapOptions/)
          maplibre_options: {
            zoom: 12,
          },

          // [Marker Types](/docs/v2/2.instances.md#marker-types)
          marker_types: [
            {
              // The Title is used to create the "pub" Type Key
              marker_title: "Pub",
              marker_icon: "ion-beer",
              marker_colour: "brown",
            },
          ],
        },
      });

      // Load this GeoJSON, which contains a single "pub" Marker
      instance.loadGeoJSON({
        type: "FeatureCollection",
        features: [
          {
            type: "Feature",
            properties: {
              type: "pub",
              title: "The Scarlet Ibis",
              description:
                "Great pub, great food! Especially after a Long Ride üö¥üçîüçüüç∫üç∫üí§",
              image_large_url: "https://www.waymark.dev/assets/geo/pub.jpeg",
            },
            geometry: {
              type: "Point",
              coordinates: [-128.0094, 50.6539],
            },
          },
        ],
      });
    </script>
  </body>
</html>
```

# Instance

The Instance is the central component of Waymark JS. It is used to display Basemaps, Overlays and an interface for interacting with the Map.

## Instances

Instances are loaded inside a `<div>` element and multiple Instances can be created on a single page. Each Instance can be configured independently, with its own Basemaps, Marker Types and Data.

### Creating an Instance

To create an instance, first add a `<div>` element to your HTML, with an ID to target it:

```html
<div id="my-map" style="height: 480px"></div>
```

To create an Instance, use the `Instance` class and pass the configuration object to the constructor. This includes a `map_options` object, with the ID of the `<div>` element to contain the Map.

```javascript
// Create a Waymark Instance with this configuration
const instance = new Instance({
  map_options: {
    div_id: "my-map", // The ID of the div to contain the Map
  },
});
```

### Configuration

Each Instance is provided its own configuration, as a JavaScript object, which is passed to the `Instance` constructor.

This contains options for how the Map should behave, such as the initial zoom level, centre coordinates and available Basemaps. It also contains options for the types of Overlays that can be added to the Map, such as Marker Types, Line Types and Shape Types.

```javascript
const config = {
  map_options: {
    div_id: "my-map", // The ID of the div to contain the Map
    maplibre_options: {
      zoom: 12, // Initial zoom level
      center: [-2.548828125, 51.46769693762546], // Initial centre coordinates [lng, lat]
    },
    marker_types: [
      {
        marker_title: "Pub",
        marker_icon: "ion-beer",
        marker_colour: "brown",
      },
    ],
  },
};
```

### Data

Geographical data is represented in [GeoJSON](https://geojson.org/) format. Data can be [loaded](viewer#loading-data) into the Instance using the `load_json` method, which accepts a GeoJSON object as an argument.

```javascript
// Load GeoJSON data
instance.loadGeoJSON({
  type: "FeatureCollection",
  features: [
    {
      type: "Feature",
      geometry: { type: "Point", coordinates: [-85.038, 49.4595] },
      properties: { type: "food" },
    },
  ],
});
```

> [!NOTE]
> The object is expected to be a [FeatureCollection](https://geojson.org/geojson-spec.html#feature-collection-objects) with an array of [Features](https://geojson.org/geojson-spec.html#feature-objects), even if only one Feature is being added.

The current state of the Map is accessible through the `toGeoJSON` method, which returns a GeoJSON object representing all the Overlays currently on the Map.

```javascript
// Get GeoJSON data
const mapData = instance.toGeoJSON();
```

## Map Options

These options, provided in the `map_options` object, are used to customise both Viewer and Editor Modes.

| Option             | Values | Description                                                                                                                               | Example                        |
| ------------------ | ------ | ----------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------ |
| `map_div_id`       | string | The ID of the HTML element to contain the Map. Defaults to `waymark-instance`.                                                            | `my-map`                       |
| `tile_layers`      | array  | An array of Basemaps to be used on the Map.                                                                                               | [See Below](#basemaps)         |
| `marker_types`     | array  | An array of Marker Types to be used on the Map.                                                                                           | [See Below](#marker-types)     |
| `line_types`       | array  | An array of Line Types to be used on the Map.                                                                                             | [See Below](#line-types)       |
| `shape_types`      | array  | An array of Shape Types to be used on the Map.                                                                                            | [See Below](#shape-types)      |
| `maplibre_options` | object | Options passed directly to [MapLibre GL JS](https://maplibre.org/maplibre-gl-js/docs/API/type-aliases/MapOptions/) when creating the Map. | [See Below](#maplibre-options) |

### To-do:

> [!IMPORTANT]
> The following options are planned for a future release.

| Option             | Values  | Description                                                                      | Example             |
| ------------------ | ------- | -------------------------------------------------------------------------------- | ------------------- |
| `map_init_basemap` | string  | The initial basemap of the Map. Use the exact title, including spaces.           | `Satellite Imagery` |
| `show_scale`       | `1`/`0` | Whether to show the scale on the Map.                                            | `1`                 |
| `debug_mode`       | `1`/`0` | Whether to enable debug mode. This will output debug information to the console. | `1`                 |

### Basemaps

Waymark uses the excellent [OpenStreetMap](https://www.openstreetmap.org/) as it‚Äôs default Basemap and supports [many other providers](https://leaflet-extras.github.io/leaflet-providers/preview/).

Basemaps are added to the Map using the `map_options.tile_layers` array, each Basemap is an object with the following options:

| Option              | Values   | Description                                                                                                     | Example                                                                                   |
| ------------------- | -------- | --------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------- |
| `layer_name`        | string   | The Name will appear in a dropdown list shown by the Map when multiple Basemaps have been entered.              | `OpenStreetMap`                                                                           |
| `layer_url`         | string   | Many mapping services support the Slippy Map format. Waymark requires URLs that contain `{z}`, `{x}` and `{y}`. | `https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png?r=1`                                  |
| `layer_attribution` | string   | The attribution to be displayed on the Map.                                                                     | `&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors` |
| `layer_max_zoom`    | `0`-`18` | The maximum zoom level of the Basemap.                                                                          | `14`                                                                                      |

This is an example of a Basemap configuration:

```javascript
const config = {
  map_options: {
    tile_layers: [
      {
        layer_name: "OpenStreetMap",
        layer_url: "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png?r=1",
        layer_attribution:
          '@copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
        layer_max_zoom: "18",
      },
      {
        layer_name: "OpenTopoMap",
        layer_url: "https://{a|b|c}.tile.opentopomap.org/{z}/{x}/{y}.png",
        layer_attribution:
          '¬© <a href="https://openstreetmap.org/copyright">OSM</a>-Mitwirkende, SRTM | ¬© <a href="http://opentopomap.org" data-moz-translations-id="285">OpenTopoMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>',
        layer_max_zoom: "17",
      },
    ],
  },
};
```

> [!TIP]
> OpenStreetMap is the default Basemap. If you do not provide any Basemaps, OpenStreetMap will be used.

### Types

Customise how Overlays are displayed on the Map. When you add an Overlay (Marker, Line or Shape) to the Map you may want to style it in a certain way. In the case of Markers, you may want to use certain icons and colours.

Types allow you set these styles once, using the `map_options.marker_types`, `map_options.line_types` and `map_options.shape_types` arrays. Once a type has been provided, an Overlay can be assigned to it using the `type` feature property.

We can create a new Marker Type `pub` by adding it to the `marker_types` array like this:

```javascript
const config = {
  map_options: {
    marker_types: [
      {
        marker_title: "Pub",
        marker_shape: "marker",
        marker_size: "large",
        icon_type: "icon",
        marker_icon: "ion-beer",
        marker_colour: "#fbfbfb",
        icon_colour: "#754423",
      },
    ],
  },
};
```

When a Marker is added to the Map, it can be associated with the "Pub" Type by setting the `type` feature property to `pub`:

```json
{
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [-2.548828125, 51.46769693762546]
      },
      "properties": {
        "type": "pub",
        "title": "Great place for a pint!"
      }
    }
  ]
}
```

#### Marker Types

Marker Types are added to the Map using the `marker_types` array, each Marker Type is an object with the following options:

| Option          | Values                          | Description                                                                                                                                                                                                                                                                   | Example   |
| --------------- | ------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------- |
| `marker_title`  | string                          | What kind of Marker is this? E.g. `Photo`, `Grocery Store`, `Warning!`. Marker Titles should be unique and are used to generate [Type Keys](#type-keys).                                                                                                                      | `Pub`     |
| `marker_shape`  | `marker`, `circle`, `rectangle` | Which shape of Marker to use. Circles and Squares are centered at the specified location, Markers point down to that location.                                                                                                                                                | `marker`  |
| `marker_size`   | `small`, `medium`, `large`      | Which size of Marker to use.                                                                                                                                                                                                                                                  | `large`   |
| `marker_colour` | CSS Color                       | The Marker background colour, provided as a CSS colour (e.g. `white`, `#ffba00`, `rgb(255, 186, 0)`).                                                                                                                                                                         | `#da3d20` |
| `icon_type`     | `icon`, `text`, `html`          | Font Icons are available from Font Awesome and Ionic Icons. Simple Text or Emojis are supported, as well as custom HTML.                                                                                                                                                      | `icon`    |
| `marker_icon`   | string                          | Enter the `text`/`html` ([Emojis](https://emojifinder.com/) and nested HTML supported!) For `icon` enter the [Ionicons](https://ionic.io/ionicons/v2/cheatsheet.html) or [Font Awesome](https://fontawesome.com/v4/cheatsheet/), icon name e.g. `ion-camera`, or `fa-camera`. | `üç∫`      |
| `icon_colour`   | CSS Color                       | The colour of the icon, provided as a CSS colour (e.g. `white`, `#ffba00`, `rgb(255, 186, 0)`).                                                                                                                                                                               | `#ffba00` |

The following is an example of a Marker Type configuration:

```javascript
const config = {
  map_options: {
    marker_types: [
      {
        marker_title: "Pub",
        marker_shape: "marker",
        marker_size: "large",
        icon_type: "icon",
        marker_icon: "ion-beer",
        marker_colour: "#fbfbfb",
        icon_colour: "#754423",
      },
    ],
  },
};
```

#### Line Types

Line Types are added to the Map using the `line_types` array, each Line Type is an object with the following options:

| Option         | Values     | Description                                                                                                                                             | Example     |
| -------------- | ---------- | ------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------- |
| `line_title`   | string     | What kind of Line is this? E.g. `Bike Path`, `Walking Only`, `Dark Red`. Line Titles should be unique and are used to generate [Type Keys](#type-keys). | `Bike Path` |
| `line_colour`  | CSS Colour | The colour of the Line, provided as a CSS colour (e.g. `white`, `#ffba00`, `rgb(255, 186, 0)`).                                                         | `#3cbc47`   |
| `line_weight`  | number     | The width of the Line, in pixels.                                                                                                                       | `2`         |
| `line_opacity` | `0`-`1`    | The opacity of the Line, between `0.0` and `1.0`.                                                                                                       | `0.85`      |

The following is an example of a Line Type configuration:

```javascript
const config = {
  map_options: {
    line_types: [
      {
        line_title: "Bike Path",
        line_colour: "#3cbc47",
        line_weight: "2",
        line_opacity: "0.5",
      },
    ],
  },
};
```

#### Shape Types

Shape Types are added to the Map using the `shape_types` array, each Shape Type is an object with the following options:

| Option         | Values     | Description                                                                                                                                       | Example   |
| -------------- | ---------- | ------------------------------------------------------------------------------------------------------------------------------------------------- | --------- |
| `shape_title`  | string     | What kind of Shape is this? E.g. `Park`, `Danger!`, `Light Blue`. Shape Titles should be unique and are used to generate [Type Keys](#type-keys). | `Park`    |
| `shape_colour` | CSS Colour | The colour of the Shape, provided as a CSS colour (e.g. `white`, `#ffba00`, `rgb(255, 186, 0)`).                                                  | `#81d742` |
| `fill_opacity` | number     | The opacity of the inside of the Shape, between `0.0` and `1.0`.                                                                                  | `0.5`     |

The following is an example of a Shape Type configuration:

```javascript
const config = {
  map_options: {
    shape_types: [
      {
        shape_title: "Park",
        shape_colour: "#81d742",
        fill_opacity: "0.5",
      },
    ],
  },
};
```

#### Type Keys

Type Keys are a unique string that identifies a Type. The Type Title is used to create the Type Key, by removing any non-alpha-numeric characters and converting it to lowercase.

> [!TIP]
> The Type Key for "Pub" would be `pub`. The Type Key for "A Much Longer Title" would be `amuchlongertitle`.

When assigning a Type to an Overlay, the `type` feature property must match the Type Key. For example, to assign the "Pub" Type to a Marker:

```json
{
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "properties": {
        "type": "pub",
        "title": "Great place for a pint!"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [-2.548828125, 51.46769693762546]
      }
    }
  ]
}
```

Waymark JS adds the Type Key to the Overlay using the `waymark-marker-[type_key]` class. For example, the "Pub" Type would be:

```html
<div class="waymark-marker waymark-marker-pub">
  <div class="waymark-marker-background" style="background:#fbfbfb;"></div>
  <i
    style="color:#754423;"
    class="waymark-marker-icon waymark-icon-icon ion ion-beer"
  ></i>
</div>
```

You can use this class to target specific Types in your CSS, for example:

```css
/* Adjust the "Pub" Marker Text Icon size */
.waymark-marker-pub i {
  font-size: 24px !important;
}
```

> [!TIP]
> Use your browser‚Äôs inspector ([Firefox](https://developer.mozilla.org/en-US/docs/Tools/Page_Inspector/How_to/Open_the_Inspector) / [Chrome](https://developer.chrome.com/docs/devtools/open/)) to find Type keys.

### MapLibre Options

These options, provided in the `map_options.maplibre_options` object, are passed directly to [MapLibre GL JS](https://maplibre.org/maplibre-gl-js/docs/API/type-aliases/MapOptions/) when creating the Map. This allows you to customise the Map further, using any of the options available in MapLibre GL JS. Some examples:

| Option        | Values             | Description                                      | Example                             |
| ------------- | ------------------ | ------------------------------------------------ | ----------------------------------- |
| `center`      | array `[lng, lat]` | The initial geographical centerpoint of the Map. | `[-2.548828125, 51.46769693762546]` |
| `zoom`        | number             | The initial zoom level of the Map.               | `12`                                |
| `minZoom`     | number             | The minimum zoom level of the Map.               | `0`                                 |
| `maxZoom`     | number             | The maximum zoom level of the Map.               | `18`                                |
| `interactive` | `true`/`false`     | Whether the Map is interactive.                  | `true`                              |

> [!TIP]
> View the [MapLibre GL JS API](https://maplibre.org/maplibre-gl-js/docs/API/type-aliases/MapOptions/) for the full list of available `maplibre_options`.
